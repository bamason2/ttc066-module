
%% Model Parameters

speeds=1000:500:6500;         %[rpm]       vector of speed breakpoints used in lookup tables


%% Engine Parameters

Vsw=5e-3;       %[m^3]        swept volume

Vman=7.81e-3;   %[m^3]        intake manifold volume

Pman0=97e3;     %[Pa]         initial manifold pressure i.e. P_0

R=0.287e3;      %[kJ/kgK]     universal gas constant

Tman=293;       %[K]          manifold temperature

Patm=101.3e3;   %[Pa]         atmospheric (ambient) pressure

gamma=1.4;      %[]           Cp/Cv for air


%% Intake Manifold Parameters


vol_eff=[               % volumetric efficiency rows are speed breakpoints, columns are the manifold pressure breakpoints (pman_bp)
    0.509807904930537,0.531463303232346,0.556682598328391,0.598472181378903,0.660850128742888,0.675104762190648,0.686467866107983,0.695023088834803,0.700863360575304,0.704088080836276;
    0.521805510040756,0.552521052530728,0.584706570503711,0.627691692564910,0.675185956482959,0.690044541161838,0.702138724826866,0.711537327925254,0.718319852711709,0.722573246509490;
    0.518823123286442,0.561861425322614,0.603870280155564,0.650056004942332,0.679728285953082,0.696887902606891,0.711129433441039,0.722532395504317,0.731184548354034,0.737179396575631;
    0.511814062527471,0.555759100692946,0.599068030308813,0.647300179779589,0.677948846120109,0.698224100133734,0.715297204698661,0.729268220302088,0.740241854899877,0.748326055933599;
    0.505194734945384,0.545348032173272,0.585939115126765,0.634064572095814,0.673431823145883,0.696745238533188,0.716588542801138,0.733078782149248,0.746335030373746,0.756477774875516;
    0.502937631635729,0.540903675550502,0.579716260118673,0.627116028025527,0.669754276186142,0.695165181928661,0.716985340922805,0.735337377358914,0.750344869074191,0.762132059073113;
    0.509200411034839,0.546306916147709,0.584401381492739,0.631163899799630,0.670460863294812,0.696191189064452,0.718478625020747,0.737435154624339,0.753174003968349,0.765809265767072;
    0.531822785740337,0.565122297493084,0.599960986606995,0.643663692984942,0.679132877433734,0.702548275732661,0.723069943934747,0.740772921432440,0.755736825833892,0.768044466159294;
    0.588338215786757,0.609785713479983,0.634700390193674,0.670064021206792,0.699551592587782,0.717056304338694,0.732800405777370,0.746766220993164,0.758955019148380,0.769381274008123;
    0.701673625861626,0.696517963480189,0.699686555392590,0.717931346367602,0.735955919985402,0.742759800605384,0.749807360614186,0.756863679684698,0.763758714726024,0.770367640426506;
    0.879482473566334,0.833529395285728,0.804254368433676,0.796402973260424,0.793394374424554,0.783110497415707,0.776408729434111,0.772578625014499,0.771093259101848,0.771553614883093;
    0.930000000000000,0.930000000000000,0.930000000000000,0.913616100686019,0.878171350704072,0.842202605794108,0.815214979409897,0.795533974096175,0.781931600663268,0.773491072406284
    ];
 
pman_bp=linspace(0.5e5,1.1e5,10);      %[Pa]     manifold pressure table breakpoints      

%% Throttle Body Parameters

u0=7/360*2*pi;          %[radians]      minimum throttle opening

D=0.083;                %[m]            throttle bore diameter

d=0.0073;               %[m]            throttle spindle diameter

a=d/D;                  %[]

umax=80.93/360*2*pi;    %[radians]


throttle_cd=[           %[]         throttle opening angle [degrees] (column 1) and discharge coefficient [] (column 2)
0       0.001331948;
0.31	0.001807051;
1.15	0.002666012;
1.89	0.004708067;
2.52	0.005845788;
3.05	0.006641765;
3.65	0.00816378;
4.16	0.00999624;
4.55	0.010494028;
5.7     0.013642211;
6.4     0.016056894;
7.9     0.021396847;
8.83	0.025170163;
9.68	0.027920015;
10.96	0.034391641;
12.08	0.039230262;
13.97	0.049950859;
14.87	0.054595127;
16.62	0.063946133;
18.25	0.074585989;
18.83	0.078182455;
19.58	0.083160216;
21.81	0.100091804;
24.83	0.12683564;
26.23	0.141314003;
28.45	0.165374308;
30.02	0.182372327;
30.94	0.194790909;
32.76	0.216143814;
34.25	0.236844665;
37.05	0.276096357;
38.7	0.300161965;
40.38	0.325941131;
41.91	0.352768758;
45.02	0.40800268;
46.62	0.440757453;
49.7	0.501956602;
51.52	0.542224395;
53.08	0.577971468;
55.86	0.646506542;
56.84	0.66956035;
59.8	0.754108483;
60.97	0.771200934;
62.61	0.829232687;
65.53	0.869017963;
67.14	0.89186583;
69.21	0.933282151;
71.14	0.952687328;
74.49	0.975542719;
75.32	0.978655272;
76.2	0.982551315;
77.04	0.992996272;
78.26	0.98867147;
90      1
];


	

%% Torque generation parameters

torques=[
    46.9762751433610,717.455440528533,1133.94513426762,1157.78233065130,676.708489842129,-421.534927997353,-2249.20646270460,-4918.56465411707,-8541.86804207221,-13231.3751664075;
    -230.698849638244,332.354241687695,897.083543266026,1561.22135980417,2265.64037942858,2948.64243365524,3548.52935400014,4003.60297197926,4252.16511910860,4232.51762690413;
    -373.724996278750,77.1120745333458,505.938086658963,882.323931974091,1146.25720169062,1271.49416622463,1231.79109599223,1000.90426140950,552.589932892537,-139.395619142565;
    -371.392064556663,-63.3473953494523,277.055981799220,621.736146222371,932.558007961065,1199.92172230261,1418.06102065926,1581.20963444326,1683.60129506688,1719.46973394235;
    -503.009631836647,-164.437290355412,138.182462478339,420.646147979688,705.380785415728,985.941238588859,1263.63201679881,1538.41145920783,1810.23790497819,2079.06969327215;
    -453.313834796323,-203.905432609593,40.8649661015664,281.421474478772,521.453129862071,757.888767186228,992.233822421124,1224.40323998225,1454.36847721172,1682.10099145163;
    -402.891232354098,-225.324000805785,-33.1584523712048,172.580921314477,383.110566866273,591.872625667696,813.170898276009,1051.37462957447,1303.64757970654,1567.15350881564;
    -369.286938181949,-237.388571968073,-85.8635768032186,83.3712802666505,269.102172328012,456.535967663899,643.111872381273,838.026728157872,1040.18337911028,1249.08424640382;
    -554.432203285015,-371.289730437767,-190.776428408339,-12.9614100051936,162.086211963208,334.073253260520,506.335055976515,676.288190360196,839.400083763859,995.330300625137;
    -398.048041619567,-321.719528946767,-221.212576863722,-98.7970699753654,43.2571071133705,202.758646596547,369.460237543508,535.545654452494,705.044205295878,888.633378928683;
    -324.567305593628,-303.131899743740,-248.746078118161,-164.602273038881,-53.8929168278926,80.1895581928142,234.635427824612,396.746934572812,557.750421181703,725.131515298174;
    -814.033720588437,-666.348444487206,-516.886232295070,-365.672487056438,-212.732611815718,-58.0920096173205,98.2239164943472,256.259239561676,415.175138124371,573.183518370303
    ]


airflow_bp=[0.0207577964628217,0.0461644518466602,0.0715711072304987,0.0969777626143372,0.122384417998176,0.147791073382014,0.173197728765853,0.198604384149691,0.224011039533530,0.249417694917368];
